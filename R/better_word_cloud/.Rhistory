dissimilarity(speeches.matrix, method="manhattan")
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful wordcloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful wordcloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))
dist(speeches.df)
term.dist<-dist(speeches.df, method="cosine")
term.dist<-dist(speeches.df)
summary(term.dsit)
summary(term.dist)
?dist
hclust(freq.dist)
hclust(term.dist)
plot(hclust(term.dist))
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful wordcloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)
summary(speeches.df)
nrow(speeches.df)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful wordcloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
#
# Create distance measures#
term.dist<-dist(speeches.df, method="manhattan")#
term.clust<-hclust(term.dist)
plot(term.clust)
plot(term.clust, color="r")
?plot
plot(term.clust, color="r")
?princomp
princomp(speeches.df)
princomp(term.dist)
summary(term.dist)
nrow(term.dist)
dims(term.dist)
dims(term.dist)
dim(term.dist)
?dim
nrow(term.dist)
ncol(term.dist)
svd(term.dist)
term.svd<-svd(term.dist)
dim(term.svd)
summaryt(term.svd)
summary(term.svd)
class(term.svd)
names(term.svd)
?svd
names(term.svd, nu=2)
term.svd<-svd(term.dist, nu=2)
names(term.svd, nu=2)
names(term.svd)
term.svd$u
names(term.svd, nu=1)
term.svd<-svd(term.dist, nu=1)
term.svd$u
term.svd$v
term.svd<-svd(term.dist, nu=1, v=1)
term.svd<-svd(term.dist, nu=1, nv=1)
plot(term.svd$u, term.svd$v)
term.svd<-svd(term.dist)
term.svd$d
plot(term.svd$d)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful wordcloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
#
# Create distance measures#
term.dist<-dist(speeches.df, method="manhattan")#
term.clust<-hclust(term.dist)
term.clust
?kmeans
?princomp
USArrests
speeches.df
princomp(speeches.df, cor=TRUE)
plot(princomp(speeches.df, cor=TRUE))
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful wordcloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
#
# Create distance measures#
term.dist<-dist(speeches.df, method="manhattan")#
#
# Heirarchical clustering#
term.clust<-hclust(term.dist)#
#
# Principal components analysis#
term.pca<-princomp(speeches.df, cor=TRUE)
summary(term.pca)
screeplot(term.pca)
term.dist[,1]
term.dist1
term.dist[1]
term.dist[1,]
term.dist[,1]
term.dist[,]
dim(term.dist)
term.dist
speeches.df
?hclust
svd(term.dist)
svd(term.dist)$d
?svd
eigen(term.dist)
eigen(term.dist)$vector
dist.eigen<-eigen(term.dist)
names(dist.eigen)
dist.eigen$values
speeches.df$obama.txt-speeches.df$palin.txt
plot(speeches.df$obama.txt-speeches.df$palin.txt)
speech.matrix
speeches.matrix
length(strsplit(speeches[[1]]))
length(strsplit(speeches[[1]], " "))
length(strsplit(speeches[[2]], " "))
test<-strsplit(speeches[[2]], " ")
test[1]
test[2]
test[3]
length(unlist(strsplit(speeches[[2]], " ")))
length(unlist(strsplit(speeches[[1]], " ")))
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)
summary(speeches.df)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/nrow(speeches.matrix), palin.norm=speeches.df$palin.txt/nrow(speeches.matrix))
summary(speeches.df)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)
summary(speeches.df)
setwd('/Users/agconway/Desktop/better_word_cloud')
term.dist<-dist(speeches.df, method="manhattan")
setwd('/Users/agconway/Desktop/better_word_cloud')
term.clust<-hclust(term.dist)
plot(term.clust)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
#
#
# Create distance measure#
term.dist<-dist(speeches.df, method="euclidian")#
#
# Heirarchical clustering#
term.clust<-hclust(term.dist)
plot(term.clust)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
#
#
# Create distance measure#
term.dist<-dist(speeches.df, method="manhattan")#
#
# Heirarchical clustering#
term.clust<-hclust(term.dist)
plot(term.clust)
plot(obama.norm, palin.norm, data=speeches.df)
plot(speeches.df$obama.norm, speeches.df$palin.norm)
plot(speeches.df$obama.norm-speeches.df$palin.norm)
plot(log(speeches.df$obama.norm-speeches.df$palin.norm))
plot(speeches.df$obama.norm-speeches.df$palin.norm)
plot(1:nrow(speeches.df),speeches.df$obama.norm-speeches.df$palin.norm)
plot(speeches.df$obama.norm-speeches.df$palin.norm,1:nrow(speeches.df))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=obama.norm-palin.norm, y=1:nrow(speeches.df)))+geom_text(label=row.names, size=abs(obama.norm-palin.norm))
summary(speeches.df)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc, norm.dif=obama.norm-palin.norm)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.df=obama.txt=palin.txt, norm.dif=obama.norm-palin.norm)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.df=obama.txt-palin.txt, norm.dif=obama.norm-palin.norm)
summary(speeches.df)
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.df, y=1:nrow(speeches.df)))+geom_text(label=row.names, size=abs(obama.norm-palin.norm))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.df, y=1:nrow(speeches.df)))+geom_text(label=row.names, size=abs(norm.dif))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.df, y=1:nrow(speeches.df)))+geom_text(label=row.names, size=abs(speeches$norm.dif))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.df, y=1:nrow(speeches.df)))+geom_text(label=row.names, size=abs(speeches.df$norm.dif))
speeches.df$norm.dif
abs(speeches.df$norm.dif)
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.df, y=1:nrow(speeches.df)))+geom_text(label=row.names, aes(size=abs(speeches.df$norm.dif)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(label=row.names, aes(size=abs(speeches.df$norm.dif)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(labels=row.names, aes(size=abs(speeches.df$norm.dif)))
?geom_text
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(label=row.names(speeches.df), aes(size=abs(speeches.df$norm.dif)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=abs(speeches.df$norm.dif, label=row.names(speeches.df))))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=abs(speeches.df$norm.dif), label=row.names(speeches.df)))
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=abs(speeches.df$norm.dif), label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=2, label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=3, label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=obama.txt, label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=palin.txt, label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>1 & palin.txt>1)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.df=obama.txt-palin.txt, norm.dif=obama.norm-palin.norm)#
#
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=palin.txt, label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.df=obama.txt-palin.txt, norm.dif=obama.norm-palin.norm)#
#
ggplot(speeches.df, aes(x=norm.dif, y=1:nrow(speeches.df)))+geom_text(aes(size=palin.txt, label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(subset(speeches.df, palin.txt>obama.txt), aes(x=norm.dif, y=1:nrow(speeches.df)))+#
    geom_text(aes(size=palin.txt, label=row.names(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.df=obama.txt-palin.txt, norm.dif=obama.norm-palin.norm)#
#
palin.df<-subset(speeches.df, palin.txt>obama.txt)#
obama.df<-subset(speeches.df, obama.txt>palin.txt)#
equal.df<-subset(speeches.df, obama.txt==palin.txt)
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.txt, label=row.names(palin.df), colour=norm.dif))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.txt, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.dif), label=row.names(obama.df), size=obama.txt, color=norm.df))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.txt, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.txt, color=norm.df))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.txt, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.txt, color=norm.dif))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.txt, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.txt, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.txt, color=norm.dif))+
)
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.txt, label=row.names(palin.df), colour=norm.d#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.txt, color=norm.dif))#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.txt, color=norm.dif))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.txt, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.txt, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.txt, color=norm.dif))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(from=c(3,12))
?scale_size
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12))
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12))+scale_colour_gradiaent(low="darkred", high="darkblue", legend=FALSE)
?scale_color
?scale_color_gradient
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.df=obama.txt-palin.txt, norm.dif=obama.norm-palin.norm)#
#
palin.df<-subset(speeches.df, palin.txt>obama.txt)#
obama.df<-subset(speeches.df, obama.txt>palin.txt)#
equal.df<-subset(speeches.df, obama.txt==palin.txt)#
#
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12))+scale_colour_gradient(low="darkred", high="darkblue", legend=FALSE)
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12), legend=FALSE)+scale_colour_gradient(low="darkred", high="darkblue", legend=FALSE)
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12), legend=FALSE)+scale_colour_gradient(low="darkred", high="darkblue", legend=FALSE)+#
    scale_x_continous(limits=c(-0.005,0.005))+theme_bw()
setwd('/Users/agconway/Desktop/better_word_cloud')
#
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12), legend=FALSE)+scale_colour_gradient(low="darkred", high="darkblue", legend=FALSE)+#
    scale_x_continuos(limits=c(-0.005,0.005))+theme_bw()
?scale_x_continuous
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12), legend=FALSE)+scale_colour_gradient(low="darkred", high="darkblue", legend=FALSE)+#
    scale_x_continuous(limits=c(-0.005,0.005))+theme_bw()
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12), legend=FALSE)+scale_colour_gradient(low="darkred", high="darkblue", legend=FALSE)+#
    scale_x_continuous(limits=c(-0.006,0.006))+theme_bw()
setwd('/Users/agconway/Desktop/better_word_cloud')
ggplot(palin.df, aes(x=norm.dif, y=1:nrow(palin.df)))+geom_text(aes(size=palin.norm, label=row.names(palin.df), colour=norm.dif))+#
    geom_text(data=obama.df, aes(x=norm.dif, y=1:nrow(obama.df), label=row.names(obama.df), size=obama.norm, color=norm.dif))+#
    geom_text(data=equal.df, aes(x=norm.dif, y=1:nrow(equal.df), label=row.names(equal.df), size=obama.norm, color=norm.dif))+#
    scale_size(to=c(3,12), legend=FALSE)+scale_colour_gradient(low="darkred", high="darkblue", legend=FALSE)+#
    scale_x_continuous(limits=c(-0.006,0.006))+theme_bw()
3/40
3*2/40
3 % 2
3 %% 2
3 %% 3
table(palin.df$palin.txt)
table(obama.df$palin.txt)
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.df=obama.txt-palin.txt, norm.dif=obama.norm-palin.norm)    #
#
palin.df<-subset(speeches.df, palin.txt>obama.txt)#
obama.df<-subset(speeches.df, obama.txt>palin.txt)#
equal.df<-subset(speeches.df, obama.txt==palin.txt)#
#
optimal.spacing<-function(spaces, max) {#
    if(spaces>1) {#
        spacing<-2*spaces/max#
        lim<-spacing*(spaces/2)#
        return(seq(-lim,lim,spacing))#
    }#
    else {#
        return(0)#
    }#
}
sapply(table(obama.df$obama.txt), function(x) optimal.spacing(x, max=nrow(speeches.df)))
lapply(table(obama.df$obama.txt), function(x) optimal.spacing(x, max=nrow(speeches.df)))
unlist(lapply(table(obama.df$obama.txt), function(x) optimal.spacing(x, max=nrow(speeches.df))))
setwd('/Users/agconway/Desktop/better_word_cloud')
obama.spacing<-sapply(table(obama.df$freq.dif), function(optimal.spacing(x, max=nrow(speeches.df))))#
palin.spacing<-sapply(table(palin.df$freq.dif), function(optimal.spacing(x, max=nrow(speeches.df))))#
equal.spacing<-sapply(table(obama.df$freq.dif), function(optimal.spacing(x, max=nrow(speeches.df))))
setwd('/Users/agconway/Desktop/better_word_cloud')
obama.spacing<-sapply(table(obama.df$freq.dif), function(optimal.spacing(x, max=nrow(speeches.df))))
setwd('/Users/agconway/Desktop/better_word_cloud')
obama.spacing<-sapply(table(obama.df$freq.dif), function(x) optimal.spacing(x, max=nrow(speeches.df)))
setwd('/Users/agconway/Desktop/better_word_cloud')
obama.spacing<-sapply(table(obama.df$freq.dif), function(x) optimal.spacing(x, max=nrow(speeches.df)))#
palin.spacing<-sapply(table(palin.df$freq.dif), function(x) optimal.spacing(x, max=nrow(speeches.df)))#
equal.spacing<-sapply(table(equal.df$freq.dif), function(x) optimal.spacing(x, max=nrow(speeches.df)))
equal.spacing
equal.df
setwd('/Users/agconway/Desktop/better_word_cloud')
# File-Name:       better_word_cloud.R           #
# Date:            2011-01-26                                #
# Author:          Drew Conway#
# Email:           drew.conway@nyu.edu                                      #
# Purpose:         Create a more meaningful word-cloud#
# Data Used:       obama.txt, palin.txt#
# Packages Used:   tm, ggplot2       #
# Output File:     obama_cloud.pdf,palin_cloud.pdf#
# Data Output:     #
# Machine:         Drew Conway's MacBook Pro#
#
# Copyright (c) 2011, under the Simplified BSD License.  #
# For more information on FreeBSD see: http://www.opensource.org/licenses/bsd-license.php#
# All rights reserved.                                                         #
#
# Load libraries and data#
library(tm)#
library(ggplot2)#
#
speeches<-Corpus(DirSource("data/"))#
#
# Get word counts#
obama.wc<-length(unlist(strsplit(speeches[[1]], " ")))#
palin.wc<-length(unlist(strsplit(speeches[[2]], " ")))#
#
# Create a Term-Document matrix#
add.stops=c("applause")#
speech.control=list(stopwords=c(stopwords(),add.stops), removeNumbers=TRUE, removePunctuation=TRUE)#
speeches.matrix<-TermDocumentMatrix(speeches, control=speech.control)#
#
# Create data frame from matrix#
speeches.df<-as.data.frame(inspect(speeches.matrix))#
speeches.df<-subset(speeches.df, obama.txt>0 & palin.txt>0)#
speeches.df<-transform(speeches.df, obama.norm=speeches.df$obama.txt/obama.wc, palin.norm=speeches.df$palin.txt/palin.wc)#
speeches.df<-transform(speeches.df, freq.dif=obama.txt-palin.txt, norm.dif=obama.norm-palin.norm)    #
#
palin.df<-subset(speeches.df, palin.txt>obama.txt)#
obama.df<-subset(speeches.df, obama.txt>palin.txt)#
equal.df<-subset(speeches.df, obama.txt==palin.txt)#
#
optimal.spacing<-function(spaces, max) {#
    if(spaces>1) {#
        spacing<-2*spaces/max#
        lim<-spacing*(spaces/2)#
        return(seq(-lim,lim,spacing))#
    }#
    else {#
        return(0)#
    }#
}#
#
obama.spacing<-sapply(table(obama.df$freq.dif), function(x) optimal.spacing(x, max=nrow(speeches.df)))#
palin.spacing<-sapply(table(palin.df$freq.dif), function(x) optimal.spacing(x, max=nrow(speeches.df)))#
equal.spacing<-sapply(table(equal.df$freq.dif), function(x) optimal.spacing(x, max=nrow(speeches.df)))
equal.spacing
obama.spacing
obama.spacing$'1'
names(obama.spacing)
